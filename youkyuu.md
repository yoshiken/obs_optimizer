# OBS配信最適化ツール 要求・要件定義書

## 概要

配信者向けに、OBSの画質・音質・ビットレートを自動で最適化し、現在の設定と比較・改善提案を行うツール。配信中のリアルタイム監視により、実負荷での問題検出と動的な最適化を実現する。

---

## 解決する課題

| 課題 | 詳細 |
|------|------|
| 設定の複雑さ | ビットレート、エンコーダー、解像度、音声設定の組み合わせが多すぎて最適解がわからない |
| 環境依存 | 回線速度・PCスペック・配信プラットフォームごとに最適値が異なる |
| 検証の手間 | 設定変更のたびに配信テストが必要で、比較が困難 |
| 実負荷の未知 | ゲーム＋Live2D＋OBS同時�kind行時の負荷は初期設定では観測できない |

---

## ターゲットユーザー

- 配信初心者〜中級者（VTuber含む）
- 設定に時間をかけたくないが品質は妥協したくない層
- ゲーム配信など高負荷環境で配信する層

---

## 機能要件

### Phase 1: MVP（診断・監視機能）

#### 1.1 初期診断

| 機能 | 詳細 |
|------|------|
| OBS設定読み取り | 現在の映像/音声/出力設定を自動取得 |
| 環境分析 | 回線速度測定、CPU/GPU検出、エンコーダー対応確認 |
| 最適設定提案 | プラットフォーム別（YouTube/Twitch/ニコ生）の推奨値を算出 |
| 比較レポート | 現在 vs 推奨設定の差分を可視化、改善インパクトをスコア表示 |

#### 1.2 リアルタイム監視（常駐）

| 機能 | 詳細 |
|------|------|
| OBSメトリクス監視 | CPU使用率、FPS、フレームレンダリング時間、ドロップフレーム |
| システム負荷監視 | GPU使用率、VRAM、プロセス別CPU、メモリ使用量 |
| ネットワーク監視 | 帯域使用量、ビットレート推移 |
| アラート通知 | 閾値超過時にトースト通知（例: GPU 95%超過、フレームドロップ検出） |
| ログ記録 | 配信セッション全体のメトリクスを時系列で保存 |

#### 1.3 分析・レポート

| 機能 | 詳細 |
|------|------|
| 問題箇所特定 | 「この瞬間にカクついた」のタイムスタンプ記録 |
| 原因分析 | ドロップの原因推定（エンコード負荷/ネットワーク/レンダリング） |
| 改善提案 | 検出された問題に基づく設定変更の推奨 |

### Phase 2: 拡張機能

| 機能 | 詳細 |
|------|------|
| ワンクリック適用 | 推奨設定をOBSに直接反映（obs-websocket経由） |
| プロファイル管理 | 用途別（雑談/ゲーム/歌枠）のプリセット |
| 競合検出 | Discord、VTube Studio等との負荷競合を検出 |
| 履歴比較 | 過去の配信セッションとのパフォーマンス比較 |

---

## 非機能要件

| 項目 | 要件 |
|------|------|
| 動作負荷 | CPU 1%未満、メモリ 100MB未満（配信への影響を最小化） |
| 起動時間 | 3秒以内 |
| 対応OS | Windows 10/11（優先）、macOS（将来対応） |
| OBSバージョン | OBS Studio 28.0以降（obs-websocket 5.x標準搭載） |
| 安定性 | ツールクラッシュ時にOBSを巻き込まない（外部プロセスとして独立） |

---

## 技術要件

### アーキテクチャ

```
外部常駐ツール（OBSプラグイン不要）
├─ obs-websocket 5.x 経由でOBS連携
├─ OS API経由でシステムメトリクス取得
└─ ローカル完結（プライバシー配慮）
```

### 技術スタック（案）

| コンポーネント | 技術 |
|--------------|------|
| フレームワーク | Tauri (Rust + WebView) |
| OBS連携 | obs-websocket-rs |
| システム監視 | sysinfo (Rust crate) |
| GPU監視 | NVML (NVIDIA) / ADL (AMD) |
| UI | React / Svelte |

### obs-websocket で取得可能なメトリクス

```json
{
  "cpuUsage": 12.5,
  "memoryUsage": 420.0,
  "activeFps": 59.94,
  "averageFrameRenderTime": 8.2,
  "renderSkippedFrames": 0,
  "outputSkippedFrames": 3,
  "outputBytes": 125000000
}
```

### 外部ツールで取得するメトリクス

| カテゴリ | 項目 |
|---------|------|
| GPU | 使用率、VRAM使用量、エンコーダー負荷 |
| CPU | 全体使用率、プロセス別使用率 |
| メモリ | 使用量、利用可能量 |
| ネットワーク | 帯域使用量、レイテンシ |

---

## 対応プラットフォームの推奨値

### YouTube Live

```yaml
video_bitrate: 4500-9000 kbps (1080p60)
audio_bitrate: 128-384 kbps
encoder: NVENC / x264 (medium)
keyframe_interval: 2秒
```

### Twitch

```yaml
video_bitrate: 6000 kbps (上限)
audio_bitrate: 160 kbps
encoder: NVENC優先
keyframe_interval: 2秒
```

### ニコニコ生放送

```yaml
video_bitrate: 6000 kbps (上限)
audio_bitrate: 192 kbps
keyframe_interval: 2秒
```

---

## ユーザーフロー

### 初回セットアップ

```
1. ツールをインストール・起動
2. OBSでWebSocketサーバーを有効化（ツール内でガイド表示）
3. 自動接続 → 現在の設定を読み取り
4. 環境分析（回線速度、ハードウェア検出）
5. 最適設定との比較レポートを表示
```

### 配信中の監視

```
1. ツールを常駐起動
2. OBSで配信開始 → 自動検知して監視開始
3. リアルタイムでメトリクス表示
4. 問題検出時にアラート通知
5. 配信終了 → セッションレポート生成
```

---

## 将来的な検討事項

| 項目 | 詳細 |
|------|------|
| 差別化 | VTuber特化（Live2D負荷考慮）vs 汎用ツール |
| マネタイズ | OSS / Freemium / 買い切り |
| マルチ配信対応 | 複数プラットフォーム同時配信の最適化 |
| クラウド連携 | 設定のバックアップ・共有機能 |

---

## 成功指標（KPI）

| 指標 | 目標値 |
|------|--------|
| ドロップフレーム検出率 | 95%以上 |
| 推奨設定適用後の改善率 | 80%のユーザーで改善 |
| ツール自体のリソース使用 | CPU 1%未満 |
| ユーザー満足度 | 4.0/5.0以上 |
